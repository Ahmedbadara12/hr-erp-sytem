import{a as J}from"./chunk-KNWLJMAU.js";import{a as K}from"./chunk-BDNCTEIP.js";import{a as F,c as A,d as H,e as j,f as D,g as R,j as V,k as L,l as P,m as Q,o as O}from"./chunk-IQAMYAZ6.js";import"./chunk-F3VP2UVQ.js";import{$a as v,Hb as z,Ia as _,Ib as I,Jb as N,Ka as d,Ma as Y,Mb as M,Na as n,O as G,Oa as i,Pa as C,Sa as S,Ta as u,Ua as p,Z as x,_a as a,a as w,ab as y,cb as f,db as h,eb as T,ga as g,gb as E,ha as k,j as q,jb as B,na as b,va as o,wa as W}from"./chunk-HYWXXBXQ.js";function ie(s,c){if(s&1&&(n(0,"option",19),a(1),i()),s&2){let e=c.$implicit;d("value",e.id),o(),y(" ",e.name," ")}}function ne(s,c){if(s&1){let e=S();n(0,"div",1)(1,"label",2),a(2,"Assignee"),i(),n(3,"select",16),T("ngModelChange",function(t){g(e);let m=p();return h(m.task.assignee,t)||(m.task.assignee=t),k(t)}),n(4,"option",17),a(5,"Select employee"),i(),_(6,ie,2,2,"option",18),i()()}if(s&2){let e=p();o(3),f("ngModel",e.task.assignee),d("disabled",e.readonly),o(3),d("ngForOf",e.employees)}}function se(s,c){if(s&1&&(n(0,"div",1)(1,"label",2),a(2,"Assignee"),i(),C(3,"input",20),i()),s&2){let e=p();o(3),d("value",e.userId)}}function ae(s,c){if(s&1){let e=S();n(0,"div",21)(1,"button",22),a(2,"Save"),i(),n(3,"button",23),u("click",function(){g(e);let t=p();return k(t.cancel.emit())}),a(4," Cancel "),i()()}}var $=(()=>{class s{constructor(e){this.employeeService=e,this.task={id:0,title:"",description:"",assignee:"",dueDate:"",status:"Pending",priority:"Medium",comments:[]},this.readonly=!1,this.role=null,this.userId=null,this.submitTask=new b,this.cancel=new b,this.employees=[]}ngOnInit(){this.role!=="Employee"?this.employeeService.getEmployees().subscribe(e=>{this.employees=e||[]}):this.userId&&(this.task.assignee=String(this.userId))}onSubmit(){this.submitTask.emit(this.task)}static{this.\u0275fac=function(r){return new(r||s)(W(K))}}static{this.\u0275cmp=x({type:s,selectors:[["app-task-form"]],inputs:{task:"task",readonly:"readonly",role:"role",userId:"userId"},outputs:{submitTask:"submitTask",cancel:"cancel"},standalone:!0,features:[E],decls:36,vars:13,consts:[[1,"p-3",3,"ngSubmit"],[1,"mb-3"],[1,"form-label"],["name","title","required","",1,"form-control",3,"ngModelChange","ngModel","disabled"],["name","description","rows","3",1,"form-control",3,"ngModelChange","ngModel","disabled"],["class","mb-3",4,"ngIf"],["type","date","name","dueDate","required","",1,"form-control",3,"ngModelChange","ngModel","disabled"],["name","status","required","",1,"form-select",3,"ngModelChange","ngModel","disabled"],["value","Pending"],["value","In Progress"],["value","Completed"],["name","priority","required","",1,"form-select",3,"ngModelChange","ngModel","disabled"],["value","Low"],["value","Medium"],["value","High"],["class","d-flex justify-content-end",4,"ngIf"],["name","assignee","required","",1,"form-select",3,"ngModelChange","ngModel","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","assignee","disabled","",1,"form-control",3,"value"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary","me-2"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(r,t){r&1&&(n(0,"form",0),u("ngSubmit",function(){return t.onSubmit()}),n(1,"div",1)(2,"label",2),a(3,"Title"),i(),n(4,"input",3),T("ngModelChange",function(l){return h(t.task.title,l)||(t.task.title=l),l}),i()(),n(5,"div",1)(6,"label",2),a(7,"Description"),i(),n(8,"textarea",4),T("ngModelChange",function(l){return h(t.task.description,l)||(t.task.description=l),l}),i()(),_(9,ne,7,3,"div",5)(10,se,4,1,"div",5),n(11,"div",1)(12,"label",2),a(13,"Due Date"),i(),n(14,"input",6),T("ngModelChange",function(l){return h(t.task.dueDate,l)||(t.task.dueDate=l),l}),i()(),n(15,"div",1)(16,"label",2),a(17,"Status"),i(),n(18,"select",7),T("ngModelChange",function(l){return h(t.task.status,l)||(t.task.status=l),l}),n(19,"option",8),a(20,"Pending"),i(),n(21,"option",9),a(22,"In Progress"),i(),n(23,"option",10),a(24,"Completed"),i()()(),n(25,"div",1)(26,"label",2),a(27,"Priority"),i(),n(28,"select",11),T("ngModelChange",function(l){return h(t.task.priority,l)||(t.task.priority=l),l}),n(29,"option",12),a(30,"Low"),i(),n(31,"option",13),a(32,"Medium"),i(),n(33,"option",14),a(34,"High"),i()()(),_(35,ae,5,0,"div",15),i()),r&2&&(o(4),f("ngModel",t.task.title),d("disabled",t.readonly),o(4),f("ngModel",t.task.description),d("disabled",t.readonly),o(),d("ngIf",t.role!=="Employee"),o(),d("ngIf",t.role==="Employee"),o(4),f("ngModel",t.task.dueDate),d("disabled",t.readonly),o(4),f("ngModel",t.task.status),d("disabled",t.readonly),o(10),f("ngModel",t.task.priority),d("disabled",t.readonly),o(7),d("ngIf",!t.readonly))},dependencies:[M,I,N,O,R,L,P,F,V,A,H,Q,D,j],encapsulation:2})}}return s})();function oe(s,c){if(s&1&&(n(0,"li",18),a(1),i()),s&2){let e=c.$implicit;o(),y(" ",e," ")}}var ee=(()=>{class s{constructor(){this.canUpdateStatus=!1,this.statusChanged=new b,this.commentAdded=new b,this.close=new b,this.newComment=""}addComment(){this.newComment.trim()&&(this.commentAdded.emit(this.newComment.trim()),this.newComment="")}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275cmp=x({type:s,selectors:[["app-task-detail"]],inputs:{task:"task",canUpdateStatus:"canUpdateStatus"},outputs:{statusChanged:"statusChanged",commentAdded:"commentAdded",close:"close"},standalone:!0,features:[E],decls:42,vars:10,consts:[[1,"card","w-100","mt-4"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"fs-5","fw-bold"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"fw-bold","mb-2"],[1,"mb-2"],[1,"form-select","d-inline","w-auto","ms-2",3,"ngModelChange","change","ngModel","disabled"],["value","Pending"],["value","In Progress"],["value","Completed"],[1,"mb-3"],[1,"list-group","mb-2"],["class","list-group-item py-1",4,"ngFor","ngForOf"],[1,"d-flex",3,"ngSubmit"],["name","newComment","placeholder","Add comment...",1,"form-control","me-2",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled"],[1,"list-group-item","py-1"]],template:function(r,t){r&1&&(n(0,"div",0)(1,"div",1)(2,"span",2),a(3,"Task Details"),i(),n(4,"button",3),u("click",function(){return t.close.emit()}),C(5,"i",4),i()(),n(6,"div",5)(7,"h5",6),a(8),i(),n(9,"p",7),a(10),i(),n(11,"div",7)(12,"strong"),a(13,"Assignee:"),i(),a(14),i(),n(15,"div",7)(16,"strong"),a(17,"Due Date:"),i(),a(18),i(),n(19,"div",7)(20,"strong"),a(21,"Status:"),i(),n(22,"select",8),T("ngModelChange",function(l){return h(t.task.status,l)||(t.task.status=l),l}),u("change",function(){return t.statusChanged.emit(t.task.status)}),n(23,"option",9),a(24,"Pending"),i(),n(25,"option",10),a(26,"In Progress"),i(),n(27,"option",11),a(28,"Completed"),i()()(),n(29,"div",7)(30,"strong"),a(31,"Priority:"),i(),a(32),i(),n(33,"div",12)(34,"strong"),a(35,"Comments:"),i(),n(36,"ul",13),_(37,oe,2,1,"li",14),i(),n(38,"form",15),u("ngSubmit",function(){return t.addComment()}),n(39,"input",16),T("ngModelChange",function(l){return h(t.newComment,l)||(t.newComment=l),l}),i(),n(40,"button",17),a(41," Add "),i()()()()()),r&2&&(o(8),v(t.task.title),o(2),v(t.task.description),o(4),y(" ",t.task.assignee,""),o(4),y(" ",t.task.dueDate,""),o(4),f("ngModel",t.task.status),d("disabled",!t.canUpdateStatus),o(10),y(" ",t.task.priority,""),o(5),d("ngForOf",t.task.comments),o(2),f("ngModel",t.newComment),o(),d("disabled",!t.newComment.trim()))},dependencies:[M,I,O,R,L,P,F,V,A,H,D,j],encapsulation:2})}}return s})();var te=(()=>{class s{constructor(){this.tasks=[{id:1,title:"Prepare Onboarding Documents",description:"Prepare and upload all onboarding documents for new hires.",assignee:"HR",dueDate:"2024-06-15",status:"Pending",priority:"High",comments:["Initial task created."]}],this.tasksSubject=new q(this.tasks)}getTasks(){return this.tasksSubject.asObservable()}getTaskById(e){return this.tasks.find(r=>r.id===e)}addTask(e){this.tasks.push(e),this.tasksSubject.next(this.tasks)}updateTask(e){let r=this.tasks.findIndex(t=>t.id===e.id);r>-1&&(this.tasks[r]=e,this.tasksSubject.next(this.tasks))}deleteTask(e){this.tasks=this.tasks.filter(r=>r.id!==e),this.tasksSubject.next(this.tasks)}static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275prov=G({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var le=(s,c,e)=>({"bg-warning text-dark":s,"bg-info text-dark":c,"bg-success":e}),de=(s,c,e)=>({"bg-danger":s,"bg-secondary":c,"bg-light text-dark":e});function me(s,c){if(s&1){let e=S();n(0,"div",1)(1,"div",21)(2,"span",3),a(3,"Add Your First Task"),i()(),n(4,"div",6)(5,"app-task-form",22),u("submitTask",function(t){g(e);let m=p();return k(m.addFirstTaskForEmployee(t))}),i()()()}if(s&2){let e=p();o(5),d("task",e.emptyTask())("readonly",!1)}}function pe(s,c){if(s&1){let e=S();n(0,"button",23),u("click",function(){g(e);let t=p();return k(t.openAddTask())}),C(1,"i",24),a(2," Add Task "),i()}}function ce(s,c){s&1&&(n(0,"th"),a(1,"Actions"),i())}function ue(s,c){if(s&1){let e=S();n(0,"td")(1,"button",27),u("click",function(t){g(e);let m=p().$implicit;return p().openEditTask(m),k(t.stopPropagation())}),C(2,"i",28),i(),n(3,"button",29),u("click",function(t){g(e);let m=p().$implicit;return p().deleteTask(m.id),k(t.stopPropagation())}),C(4,"i",30),i()()}}function ge(s,c){if(s&1){let e=S();n(0,"tr")(1,"td",25),u("click",function(){let t=g(e).$implicit,m=p();return k(m.openDetail(t))}),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td")(8,"span",26),a(9),i()(),n(10,"td")(11,"span",26),a(12),i()(),_(13,ue,5,0,"td",16),i()}if(s&2){let e=c.$implicit,r=p();Y("table-active",e.id===r.selectedTaskId),o(2),y(" ",e.title," "),o(2),v(e.assignee),o(2),v(e.dueDate),o(2),d("ngClass",B(10,le,e.status==="Pending",e.status==="In Progress",e.status==="Completed")),o(),v(e.status),o(2),d("ngClass",B(14,de,e.priority==="High",e.priority==="Medium",e.priority==="Low")),o(),v(e.priority),o(),d("ngIf",r.isAdminOrHR)}}function ke(s,c){s&1&&(n(0,"div",31),a(1," No tasks found. "),i())}function _e(s,c){if(s&1){let e=S();n(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"h5",36),a(5),i(),n(6,"button",37),u("click",function(){g(e);let t=p();return k(t.closeTaskForm())}),i()(),n(7,"div",38)(8,"app-task-form",39),u("submitTask",function(t){g(e);let m=p();return k(m.saveTask(t))})("cancel",function(){g(e);let t=p();return k(t.closeTaskForm())}),i()()()()()}if(s&2){let e=p();o(5),y(" ",e.editingTask?"Edit Task":"Add Task"," "),o(3),d("task",e.taskFormModel)("readonly",!e.isAdminOrHR)}}function fe(s,c){s&1&&C(0,"div",40)}function he(s,c){if(s&1){let e=S();n(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",41)(4,"app-task-detail",42),u("statusChanged",function(t){g(e);let m=p();return k(m.updateTaskStatus(t))})("commentAdded",function(t){g(e);let m=p();return k(m.addComment(t))})("close",function(){g(e);let t=p();return k(t.closeTaskDetail())}),i()()()()()}if(s&2){let e=p();o(4),d("task",e.selectedTask)("canUpdateStatus",e.canUpdateStatus(e.selectedTask))}}function Te(s,c){s&1&&C(0,"div",40)}var Re=(()=>{class s{constructor(e,r){this.taskService=e,this.auth=r,this.tasks=[],this.filterStatus="",this.filterAssignee="",this.showTaskForm=!1,this.showTaskDetail=!1,this.editingTask=null,this.selectedTask=null,this.taskFormModel=this.emptyTask(),this.role=null,this.userId=null,this.isAdminOrHR=!1,this.selectedTaskId=null,this.showAddTaskFormForEmployee=!1}ngOnInit(){this.taskService.getTasks().subscribe(e=>{if(this.tasks=e,this.role==="Employee"){if(this.tasks.length===0)this.showAddTaskFormForEmployee=!0;else if(this.selectedTaskId==null){let r=this.filteredTasks()[0];r&&(this.selectedTaskId=r.id,this.selectedTask=w({},r))}}}),this.auth.getRole().subscribe(e=>{this.role=e,this.isAdminOrHR=e==="Admin"||e==="HR"||e==="ProjectManager"}),this.userId=this.auth.getUserId()}filteredTasks(){return this.role==="Employee"&&this.userId!==null?this.tasks.filter(e=>e.assignee===String(this.userId)):this.tasks.filter(e=>(!this.filterStatus||e.status===this.filterStatus)&&(!this.filterAssignee||e.assignee.toLowerCase().includes(this.filterAssignee.toLowerCase())))}openAddTask(){this.isAdminOrHR&&(this.editingTask=null,this.taskFormModel=this.emptyTask(),this.showTaskForm=!0)}openEditTask(e){this.isAdminOrHR&&(this.editingTask=w({},e),this.taskFormModel=w({},e),this.showTaskForm=!0)}saveTask(e){this.isAdminOrHR&&(this.editingTask?this.taskService.updateTask(e):(e.id=this.generateId(),this.taskService.addTask(e)),this.closeTaskForm())}closeTaskForm(){this.showTaskForm=!1,this.editingTask=null}openDetail(e){this.selectedTask=w({},e),this.selectedTaskId=e.id,this.showTaskDetail=!0}closeTaskDetail(){this.showTaskDetail=!1,this.selectedTask=null,this.selectedTaskId=null}updateTaskStatus(e){this.selectedTask&&this.canUpdateStatus(this.selectedTask)&&(this.selectedTask.status=e,this.taskService.updateTask(this.selectedTask))}addComment(e){this.selectedTask&&(this.selectedTask.comments=[...this.selectedTask.comments,e],this.taskService.updateTask(this.selectedTask))}deleteTask(e){this.isAdminOrHR&&confirm("Are you sure you want to delete this task?")&&this.taskService.deleteTask(e)}emptyTask(){return{id:0,title:"",description:"",assignee:"",dueDate:"",status:"Pending",priority:"Medium",comments:[]}}generateId(){return this.tasks.length?Math.max(...this.tasks.map(e=>e.id))+1:1}canUpdateStatus(e){return e?this.role==="Employee"&&this.userId!==null?e.assignee===String(this.userId):this.isAdminOrHR:!1}addFirstTaskForEmployee(e){this.role==="Employee"&&(e.id=this.generateId(),e.assignee=String(this.userId),this.taskService.addTask(e),this.showAddTaskFormForEmployee=!1,this.selectedTaskId=e.id,this.selectedTask=w({},e))}static{this.\u0275fac=function(r){return new(r||s)(W(te),W(J))}}static{this.\u0275cmp=x({type:s,selectors:[["app-task-list"]],standalone:!0,features:[E],decls:43,vars:12,consts:[["class","card w-100 mt-4",4,"ngIf"],[1,"card","w-100","mt-4"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"fs-5","fw-bold"],[1,"badge","bg-secondary","ms-2"],["class","btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"card-body"],[1,"row","mb-3"],[1,"col-md-4"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],["value","Pending"],["value","In Progress"],["value","Completed"],["placeholder","Filter by assignee...",1,"form-control",3,"ngModelChange","ngModel"],[1,"table","table-hover"],[4,"ngIf"],[3,"table-active",4,"ngFor","ngForOf"],["class","text-center text-muted py-4",4,"ngIf"],["class","modal fade show","tabindex","-1","style","display: block; background: rgba(0,0,0,0.3);",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],[1,"card-header"],[3,"submitTask","task","readonly"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-plus","me-1"],[2,"cursor","pointer",3,"click"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"text-center","text-muted","py-4"],["tabindex","-1",1,"modal","fade","show",2,"display","block","background","rgba(0,0,0,0.3)"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"submitTask","cancel","task","readonly"],[1,"modal-backdrop","fade","show"],[1,"modal-body","p-0"],[3,"statusChanged","commentAdded","close","task","canUpdateStatus"]],template:function(r,t){r&1&&(_(0,me,6,2,"div",0),n(1,"div",1)(2,"div",2)(3,"span",3),a(4,"Task List"),i(),n(5,"span",4),a(6),i(),_(7,pe,3,0,"button",5),i(),n(8,"div",6)(9,"div",7)(10,"div",8)(11,"select",9),T("ngModelChange",function(l){return h(t.filterStatus,l)||(t.filterStatus=l),l}),n(12,"option",10),a(13,"All Statuses"),i(),n(14,"option",11),a(15,"Pending"),i(),n(16,"option",12),a(17,"In Progress"),i(),n(18,"option",13),a(19,"Completed"),i()()(),n(20,"div",8)(21,"input",14),T("ngModelChange",function(l){return h(t.filterAssignee,l)||(t.filterAssignee=l),l}),i()()(),n(22,"table",15)(23,"thead")(24,"tr")(25,"th"),a(26,"Title"),i(),n(27,"th"),a(28,"Assignee"),i(),n(29,"th"),a(30,"Due Date"),i(),n(31,"th"),a(32,"Status"),i(),n(33,"th"),a(34,"Priority"),i(),_(35,ce,2,0,"th",16),i()(),n(36,"tbody"),_(37,ge,14,18,"tr",17),i()(),_(38,ke,2,0,"div",18),i()(),_(39,_e,9,3,"div",19)(40,fe,1,0,"div",20)(41,he,5,2,"div",19)(42,Te,1,0,"div",20)),r&2&&(d("ngIf",t.role==="Employee"&&t.tasks.length===0&&t.showAddTaskFormForEmployee),o(6),y("Role: ",t.role,""),o(),d("ngIf",t.isAdminOrHR),o(4),f("ngModel",t.filterStatus),o(10),f("ngModel",t.filterAssignee),o(14),d("ngIf",t.isAdminOrHR),o(2),d("ngForOf",t.filteredTasks()),o(),d("ngIf",t.filteredTasks().length===0),o(),d("ngIf",t.showTaskForm),o(),d("ngIf",t.showTaskForm),o(),d("ngIf",t.showTaskDetail),o(),d("ngIf",t.showTaskDetail))},dependencies:[M,z,I,N,O,L,P,F,V,A,D,$,ee],encapsulation:2})}}return s})();export{Re as TaskListComponent};
