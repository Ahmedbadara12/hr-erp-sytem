import{a as G}from"./chunk-R655YCDP.js";import{e as B,h as z}from"./chunk-KH227EWI.js";import{a as b}from"./chunk-KNWLJMAU.js";import{a as y}from"./chunk-BDNCTEIP.js";import"./chunk-F3VP2UVQ.js";import{$a as f,Hb as D,Ia as _,Ib as M,Jb as O,Ka as c,Kb as q,Mb as U,Na as a,O as E,Oa as o,Pa as v,Qa as T,Ra as R,Sa as L,T as k,Ta as h,Ua as m,Z as w,Za as j,_a as l,a as S,ab as V,fb as A,ga as u,gb as $,ha as g,jb as F,kb as P,lb as H,m as d,mb as N,q as C,va as r,wa as x}from"./chunk-HYWXXBXQ.js";var I=(()=>{class n{constructor(e){this.auth=e,this.mockLeaves=[{id:1,employeeId:1,type:"Annual",from:"2024-06-01",to:"2024-06-05",status:"Approved",reason:"Family vacation"},{id:2,employeeId:2,type:"Sick",from:"2024-06-10",to:"2024-06-12",status:"Pending",reason:"Flu"},{id:3,employeeId:1,type:"Unpaid",from:"2024-07-01",to:"2024-07-03",status:"Rejected",reason:"Personal reasons"},{id:4,employeeId:2,type:"Annual",from:"2024-07-10",to:"2024-07-15",status:"Pending",reason:"Travel"},{id:5,employeeId:1,type:"Sick",from:"2024-08-01",to:"2024-08-02",status:"Pending",reason:"Medical checkup"}]}getLeaves(){return d(this.mockLeaves)}getLeaveById(e){return d(this.mockLeaves.find(t=>t.id===e))}addLeave(e){let t=this.auth.getUserId()??1,i={id:this.mockLeaves.length+1,employeeId:t,type:e.type,from:e.from,to:e.to,status:"Pending",reason:e.reason};return this.mockLeaves.push(i),d(i)}approveLeave(e){let t=this.mockLeaves.find(i=>i.id===e);t&&(t.status="Approved")}rejectLeave(e){let t=this.mockLeaves.find(i=>i.id===e);t&&(t.status="Rejected")}updateLeave(e,t){let i=this.mockLeaves.findIndex(p=>p.id===e);return i!==-1?(this.mockLeaves[i]=S(S({},this.mockLeaves[i]),t),d(this.mockLeaves[i])):d(void 0)}deleteLeave(e){let t=this.mockLeaves.findIndex(i=>i.id===e);return t!==-1?(this.mockLeaves.splice(t,1),d(!0)):d(!1)}static{this.\u0275fac=function(t){return new(t||n)(k(b))}}static{this.\u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var W=(n,s,e)=>({"badge bg-warning text-dark":n,"badge bg-success":s,"badge bg-danger":e});function X(n,s){n&1&&(a(0,"a",8),v(1,"i",9),l(2," Apply for Leave "),o())}function Y(n,s){n&1&&(a(0,"span",10),l(1,"HR can manage all leave requests"),o())}function Z(n,s){n&1&&(a(0,"th"),l(1,"Employee ID"),o())}function ee(n,s){n&1&&(a(0,"th"),l(1,"Name"),o())}function te(n,s){if(n&1&&(a(0,"td"),l(1),o()),n&2){let e=m().$implicit;r(),f(e.employeeId)}}function ne(n,s){if(n&1&&(a(0,"td"),l(1),o()),n&2){let e=m().$implicit,t=m(2);r(),V(" ",t.getEmployeeName(e.employeeId)," ")}}function ie(n,s){if(n&1){let e=L();a(0,"button",21),h("click",function(){u(e);let i=m().$implicit,p=m(2);return g(p.deleteLeave(i.id))}),v(1,"i",22),o()}}function ae(n,s){n&1&&(a(0,"button",23),v(1,"i",24),o())}function oe(n,s){if(n&1){let e=L();a(0,"button",21),h("click",function(){u(e);let i=m().$implicit,p=m(2);return g(p.deleteLeave(i.id))}),v(1,"i",22),o()}}function re(n,s){if(n&1){let e=L();a(0,"button",25),h("click",function(){u(e);let i=m().$implicit,p=m(2);return g(p.approveLeave(i.id))}),v(1,"i",26),o()}}function se(n,s){if(n&1){let e=L();a(0,"button",27),h("click",function(){u(e);let i=m().$implicit,p=m(2);return g(p.rejectLeave(i.id))}),v(1,"i",28),o()}}function le(n,s){if(n&1&&(a(0,"tr"),_(1,te,2,1,"td",13)(2,ne,2,1,"td",13),a(3,"td"),l(4),o(),a(5,"td"),l(6),o(),a(7,"td"),l(8),o(),a(9,"td")(10,"span",16),l(11),o()(),a(12,"td"),_(13,ie,2,0,"button",17)(14,ae,2,0,"button",18)(15,oe,2,0,"button",17)(16,re,2,0,"button",19)(17,se,2,0,"button",20),o()()),n&2){let e=s.$implicit,t=m(2);r(),c("ngIf",t.role!=="Employee"),r(),c("ngIf",t.role==="HR"),r(2),f(e.type),r(2),f(e.from),r(2),f(e.to),r(2),c("ngClass",F(12,W,e.status==="Pending",e.status==="Approved",e.status==="Rejected")),r(),f(e.status),r(2),c("ngIf",t.role==="Employee"),r(),c("ngIf",t.role==="HR"),r(),c("ngIf",t.role==="HR"),r(),c("ngIf",t.role==="HR"&&e.status==="Pending"),r(),c("ngIf",t.role==="HR"&&e.status==="Pending")}}function ce(n,s){if(n&1&&(T(0),a(1,"table",11)(2,"thead",12)(3,"tr"),_(4,Z,2,0,"th",13)(5,ee,2,0,"th",13),a(6,"th"),l(7,"Type"),o(),a(8,"th"),l(9,"From"),o(),a(10,"th"),l(11,"To"),o(),a(12,"th"),l(13,"Status"),o(),a(14,"th",14),l(15,"Actions"),o()()(),a(16,"tbody"),_(17,le,18,16,"tr",15),o()(),R()),n&2){let e=s.ngIf,t=m();r(4),c("ngIf",t.role!=="Employee"),r(),c("ngIf",t.role==="HR"),r(12),c("ngForOf",e)}}function me(n,s){n&1&&v(0,"app-loading-spinner")}var ye=(()=>{class n{constructor(e,t,i){this.leaveService=e,this.auth=t,this.employeeService=i,this.userId=null,this.role=null,this.employees=[]}ngOnInit(){this.userId=this.auth.getUserId(),this.auth.getRole().subscribe(e=>{this.role=e,e==="HR"?this.leaves$=this.leaveService.getLeaves():this.leaves$=this.leaveService.getLeaves().pipe(C(t=>t.filter(i=>i.employeeId===this.userId))),this.employeeService.getEmployees().subscribe(t=>this.employees=t||[])})}getEmployeeName(e){let t=this.employees.find(i=>i.id===e);return t?t.name:""}approveLeave(e){this.leaveService.approveLeave(e),this.refreshLeaves()}rejectLeave(e){this.leaveService.rejectLeave(e),this.refreshLeaves()}refreshLeaves(){this.role==="Employee"?this.leaves$=this.leaveService.getLeaves().pipe(C(e=>e.filter(t=>t.employeeId===this.userId))):this.leaves$=this.leaveService.getLeaves()}deleteLeave(e){confirm("Are you sure you want to delete this leave request?")&&this.leaveService.deleteLeave(e).subscribe(t=>{t&&(this.leaves$=this.leaveService.getLeaves())})}static{this.\u0275fac=function(t){return new(t||n)(x(I),x(b),x(y))}}static{this.\u0275cmp=w({type:n,selectors:[["app-leave-list"]],standalone:!0,features:[A([I,y]),$],decls:11,vars:6,consts:[["loading",""],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","btn btn-primary btn-sm","routerLink","/leave/apply",4,"ngIf"],["class","text-muted small",4,"ngIf"],[1,"card-body","p-0"],[4,"ngIf","ngIfElse"],["routerLink","/leave/apply",1,"btn","btn-primary","btn-sm"],[1,"fas","fa-plus"],[1,"text-muted","small"],[1,"table","table-striped","mb-0"],[1,"table-light"],[4,"ngIf"],[2,"width","120px"],[4,"ngFor","ngForOf"],[3,"ngClass"],["class","btn btn-sm btn-danger me-1","title","Delete",3,"click",4,"ngIf"],["class","btn btn-sm btn-info me-1","title","View",4,"ngIf"],["class","btn btn-sm btn-success me-1","title","Approve",3,"click",4,"ngIf"],["class","btn btn-sm btn-warning","title","Reject",3,"click",4,"ngIf"],["title","Delete",1,"btn","btn-sm","btn-danger","me-1",3,"click"],[1,"fas","fa-trash"],["title","View",1,"btn","btn-sm","btn-info","me-1"],[1,"fas","fa-eye"],["title","Approve",1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"fas","fa-check"],["title","Reject",1,"btn","btn-sm","btn-warning",3,"click"],[1,"fas","fa-times"]],template:function(t,i){if(t&1&&(a(0,"div",1)(1,"div",2)(2,"h5",3),l(3,"Leave Requests"),o(),_(4,X,3,0,"a",4)(5,Y,2,0,"span",5),o(),a(6,"div",6),_(7,ce,18,3,"ng-container",7),P(8,"async"),_(9,me,1,0,"ng-template",null,0,N),o()()),t&2){let p=j(10);r(4),c("ngIf",i.role==="Employee"),r(),c("ngIf",i.role==="HR"),r(2),c("ngIf",H(8,4,i.leaves$))("ngIfElse",p)}},dependencies:[z,B,U,D,M,O,q,G],encapsulation:2})}}return n})();export{ye as LeaveListComponent};
